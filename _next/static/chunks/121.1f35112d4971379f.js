"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[121],{3121:(e,t,r)=>{let n;r.r(t),r.d(t,{default:()=>R});var s,i,a,o=r(5155),c=r(2115);let l=window.AudioContext||window.webkitAudioContext,u=e=>{let t=new Blob([e.toString().replace(/^(\(\)\s*=>|function\s*\(\))\s*{/,"").replace(/}$/,"")]);return new Worker(URL.createObjectURL(t))},d=e=>{let t=new Event("error");return t.data=Error("Wrong state for "+e),t};class h{constructor(e,t=null){this.stream=e,this.config=t,this.state="inactive",this.em=document.createDocumentFragment(),this.encoder=u(h.encoder);let r=this;this.encoder.addEventListener("message",e=>{let t=new Event("dataavailable");t.data=new Blob([e.data],{type:r.mimeType}),r.em.dispatchEvent(t),"inactive"===r.state&&r.em.dispatchEvent(new Event("stop"))})}start(e){if("inactive"!==this.state)return this.em.dispatchEvent(d("start"));this.state="recording",n||(n=new l(this.config)),this.clone=this.stream.clone(),this.input=n.createMediaStreamSource(this.clone),this.processor=n.createScriptProcessor(2048,1,1),this.encoder.postMessage(["init",n.sampleRate]),this.processor.onaudioprocess=e=>{"recording"===this.state&&this.encoder.postMessage(["encode",e.inputBuffer.getChannelData(0)])},this.input.connect(this.processor),this.processor.connect(n.destination),this.em.dispatchEvent(new Event("start")),e&&(this.slicing=setInterval(()=>{"recording"===this.state&&this.requestData()},e))}stop(){return"inactive"===this.state?this.em.dispatchEvent(d("stop")):(this.requestData(),this.state="inactive",this.clone.getTracks().forEach(e=>{e.stop()}),this.processor.disconnect(),this.input.disconnect(),clearInterval(this.slicing))}pause(){return"recording"!==this.state?this.em.dispatchEvent(d("pause")):(this.state="paused",this.em.dispatchEvent(new Event("pause")))}resume(){return"paused"!==this.state?this.em.dispatchEvent(d("resume")):(this.state="recording",this.em.dispatchEvent(new Event("resume")))}requestData(){return"inactive"===this.state?this.em.dispatchEvent(d("requestData")):this.encoder.postMessage(["dump",n.sampleRate])}addEventListener(...e){this.em.addEventListener(...e)}removeEventListener(...e){this.em.removeEventListener(...e)}dispatchEvent(...e){this.em.dispatchEvent(...e)}}h.prototype.mimeType="audio/wav",h.isTypeSupported=e=>h.prototype.mimeType===e,h.notSupported=!navigator.mediaDevices||!l,h.encoder=()=>{let e=[];onmessage=t=>{"encode"===t.data[0]?function(t){let r=t.length,n=new Uint8Array(2*r);for(let e=0;e<r;e++){let r=2*e,s=t[e];s>1?s=1:s<-1&&(s=-1),s*=32768,n[r]=s,n[r+1]=s>>8}e.push(n)}(t.data[1]):"dump"===t.data[0]&&function(t){let r=e.length?e[0].length:0,n=e.length*r,s=new Uint8Array(44+n),i=new DataView(s.buffer);i.setUint32(0,0x52494646,!1),i.setUint32(4,36+n,!0),i.setUint32(8,0x57415645,!1),i.setUint32(12,0x666d7420,!1),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,1,!0),i.setUint32(24,t,!0),i.setUint32(28,2*t,!0),i.setUint16(32,2,!0),i.setUint16(34,16,!0),i.setUint32(36,0x64617461,!1),i.setUint32(40,n,!0);for(let t=0;t<e.length;t++)s.set(e[t],t*r+44);e=[],postMessage(s.buffer,[s.buffer])}(t.data[1])}};var p=function(e,t){var r,n,s,i,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(o){return function(c){var l=[o,c];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(a=0)),a;)try{if(r=1,n&&(s=2&l[0]?n.return:l[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,l[1])).done)return s;switch(n=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,n=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(s=(s=a.trys).length>0&&s[s.length-1])&&(6===l[0]||2===l[0])){a=0;continue}if(3===l[0]&&(!s||l[1]>s[0]&&l[1]<s[3])){a.label=l[1];break}if(6===l[0]&&a.label<s[1]){a.label=s[1],s=l;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(l);break}s[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(e){l=[6,e],n=0}finally{r=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}};window.MediaRecorder=h;var m=function(){function e(){this.mediaRecorder=null,this.recordedChunks=[],this.mediaRecorder=null,this.recordedChunks=[]}return e.prototype.init=function(){var e,t,r,n;return e=this,t=void 0,r=void 0,n=function(){var e,t=this;return p(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,navigator.mediaDevices.getUserMedia({audio:!0})];case 1:if(e=r.sent(),this.mediaRecorder=new window.MediaRecorder(e),!this.mediaRecorder)return[2,Promise.reject("MediaRecorder error: is null")];return this.mediaRecorder.addEventListener("dataavailable",function(e){e.data.size>0&&t.recordedChunks.push(e.data)}),this.mediaRecorder.addEventListener("error",function(){return Promise.reject("MediaRecorder error")}),[2,Promise.resolve()];case 2:return[2,Promise.reject(r.sent())];case 3:return[2]}})},new(r||(r=Promise))(function(s,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(a,o)}c((n=n.apply(e,t||[])).next())})},e.prototype.startRecording=function(){var e=this;return new Promise(function(t,r){if(!e.mediaRecorder)return r("MediaRecorder error: not initialized.");e.mediaRecorder.start(),t()})},e.prototype.stopRecording=function(){var e=this;return new Promise(function(t,r){if(!e.mediaRecorder)return r("MediaRecorder error: not initialized.");e.mediaRecorder.addEventListener("stop",function(){try{var n=new Blob(e.recordedChunks,{type:"audio/wav"}),s=URL.createObjectURL(n),i=new Audio(s);i.controls=!0,e.recordedChunks=[],t(i)}catch(e){r(e)}}),e.mediaRecorder.stop()})},e}(),v=r(6963);function f(){return(f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let w=function(e){return c.createElement("svg",f({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"1em",height:"1em"},e),s||(s=c.createElement("path",{d:"M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12 12-5.383 12-12S18.617 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10m6-10a6.01 6.01 0 0 1-5 5.916V19a1 1 0 1 1-2 0v-1.084A6.01 6.01 0 0 1 6 12a1 1 0 1 1 2 0c0 2.206 1.794 4 4 4s4-1.794 4-4a1 1 0 1 1 2 0m-8 0V7a2 2 0 1 1 4 0v5a2 2 0 1 1-4 0"})))};function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let b=function(e){return c.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},e),i||(i=c.createElement("path",{d:"M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12 12-5.383 12-12S18.617 0 12 0m0 22C6.486 22 2 17.514 2 12S6.486 2 12 2s10 4.486 10 10-4.486 10-10 10m2-15h-4c-1.654 0-3 1.346-3 3v4c0 1.654 1.346 3 3 3h4c1.654 0 3-1.346 3-3v-4c0-1.654-1.346-3-3-3m1 7c0 .551-.449 1-1 1h-4c-.551 0-1-.449-1-1v-4c0-.551.449-1 1-1h4c.551 0 1 .449 1 1z"})))};function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}let E=function(e){return c.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},e),a||(a=c.createElement("path",{d:"M.172 3.708A2.745 2.745 0 0 1 .917.713 2.745 2.745 0 0 1 3.965.282l18.09 8.444A3.58 3.58 0 0 1 24 10.999H4.048L.229 3.835a2 2 0 0 1-.057-.127M4.062 13 .309 20.175a1 1 0 0 0-.054.122 2.74 2.74 0 0 0 .749 2.993 2.76 2.76 0 0 0 1.841.708c.409 0 .819-.092 1.201-.279l18.011-8.438a3.58 3.58 0 0 0 1.945-2.28z"})))},R=(0,c.memo)(function(e){let{rows:t,handleChange:r,handleKeyDown:n,submitHandler:s,settingsTextarea:i,textareaRef:a,answer:l,recordHandler:u,isRecord:d}=function(e){let[t,r]=(0,c.useState)(""),[n,s]=(0,c.useState)(1),i=(0,c.useRef)(null),[a,o]=(0,c.useState)(!1),l=(0,c.useRef)(new m),[u,d]=(0,c.useState)(null),h=(0,c.useCallback)(()=>{if(!(t.length||u))return;let r=u||t;e.sendAnswerHandler(r),p()},[t,u,e]);(0,c.useEffect)(()=>{u&&h()},[u,h]);let p=()=>{r(""),s(1),d(null)},f=e.isTouchDevice?{autoFocus:!1}:{autoFocus:!0,onBlur:()=>{i.current&&(i.current.focus(),i.current.selectionStart=t.length)}},w=async()=>{try{await l.current.init(),await l.current.startRecording(),o(!0)}catch(e){console.error("Error starting the audio recorder:",e)}},g=async()=>{try{let e=await l.current.stopRecording();o(!1),d(e)}catch(e){console.error("Error stopping the audio recorder:",e)}};return{rows:n,handleChange:e=>{r(e.target.value);let t=e.target.rows;e.target.rows=1;let n=parseFloat(getComputedStyle(e.target).lineHeight),i=Math.ceil(e.target.scrollHeight/n);i===t&&(e.target.rows=i),i>6&&(e.target.rows=6),s(i<6?i:6)},handleKeyDown:e=>{e.key===v.z.ENTER&&e.shiftKey||e.key===v.z.ENTER&&(e.preventDefault(),h())},submitHandler:h,settingsTextarea:f,textareaRef:i,answer:t,recordHandler:()=>a?g():w(),isRecord:a}}(e);return(0,o.jsx)("div",{onKeyDown:n,className:"pb-4",children:(0,o.jsxs)("div",{className:"flex gap-2 relative",children:[(0,o.jsx)("label",{className:"grow shadow-md rounded-md p-3 bg-white flex",children:(0,o.jsx)("textarea",{className:"resize-none focus:outline-none w-full mr-24",rows:t,ref:a,onChange:r,value:l,placeholder:"Enter answer here...",...i})}),(0,o.jsx)("button",{type:"button",className:"rounded-md p-1 shrink-0 mt-auto absolute right-14 bottom-1.5",onClick:u,children:d?(0,o.jsx)(b,{className:"w-7 h-7 fill-violet-400"}):(0,o.jsx)(w,{className:"w-7 h-7 fill-violet-400"})}),(0,o.jsx)("button",{type:"button",className:"bg-violet-400 p-2.5 rounded-md shrink-0 mt-auto absolute right-2 bottom-1.5",onClick:s,children:(0,o.jsx)(E,{className:"w-4 h-4 fill-white"})})]})})})}}]);